From 80d5c128db8aa46004ad125ba826aa50ca200284 Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Fri, 20 Feb 2026 11:08:33 +0200
Subject: [PATCH] board: compulab: fdt: Issue fdt_set_env_addr() if
 CONFIG_ENV_IS_IN_MMC is on

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 board/compulab/common/fdt.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/board/compulab/common/fdt.c b/board/compulab/common/fdt.c
index 91d8ad9d70e..735658d7fe4 100644
--- a/board/compulab/common/fdt.c
+++ b/board/compulab/common/fdt.c
@@ -51,6 +51,7 @@ void fdt_set_sn(void *blob)
 
 int fdt_set_env_addr(void *blob)
 {
+#ifdef CONFIG_ENV_IS_IN_MMC
 	char tmp[32];
 	int nodeoff = fdt_add_subnode(blob, 0, "fw_env");
 	int env_dev = get_env_dev();
@@ -72,5 +73,6 @@ int fdt_set_env_addr(void *blob)
 				break;
 		}
 	}
+#endif
 	return 0;
 }
-- 
2.34.1

